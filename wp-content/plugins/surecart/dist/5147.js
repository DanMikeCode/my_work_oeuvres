"use strict";(self.webpackChunk_surecart_surecart=self.webpackChunk_surecart_surecart||[]).push([[5147],{9555:function(e,t,n){n.d(t,{a:function(){return a},c:function(){return c},g:function(){return o},h:function(){return l},i:function(){return d}});var i=n(4942);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(e){return((null==e?void 0:e.data)||[]).map((function(e){return u(u({},(null==e?void 0:e.id)?{id:e.id}:{}),{},{price_id:e.price.id,quantity:e.quantity})}))},o=function(e,t){return((null==e?void 0:e.data)||[]).find((function(e){return e.price.id===t}))},d=function(e,t){var n;return!!((null==(n=null==t?void 0:t.line_items)?void 0:n.data)||[]).map((function(e){return e.price.id})).find((function(t){return(null==e?void 0:e.id)===t}))},a=function(e,t){var n;return!!((null==(n=null==t?void 0:t.line_items)?void 0:n.data)||[]).map((function(e){var t;return(null===(t=null==e?void 0:e.bump)||void 0===t?void 0:t.id)||(null==e?void 0:e.bump)})).find((function(t){return(null==e?void 0:e.id)===t}))},l=function(e){var t,n,i;return!!(null===(n=null===(t=null==e?void 0:e.line_items)||void 0===t?void 0:t.data)||void 0===n?void 0:n.length)&&(null===(i=null==e?void 0:e.line_items.data)||void 0===i?void 0:i.some((function(e){var t;return null===(t=null==e?void 0:e.price)||void 0===t?void 0:t.recurring_interval_count})))}},5147:function(e,t,n){n.r(t),n.d(t,{sc_line_items_provider:function(){return s}});var i=n(9062),r=n(5861),u=n(5671),c=n(3144),o=n(1284),d=n.n(o),a=n(8860),l=n(9555),s=function(){function e(t){(0,u.Z)(this,e),(0,a.r)(this,t),this.scUpdateLineItems=(0,a.c)(this,"scUpdateLineItems",7),this.order=void 0,this.syncItems=[]}var t;return(0,c.Z)(e,[{key:"handleLineItemToggle",value:function(e){var t=e.detail;this.addSyncItem("toggle",t)}},{key:"handleLineItemRemove",value:function(e){var t=e.detail;this.addSyncItem("remove",t)}},{key:"handleLineItemAdd",value:function(e){var t=e.detail;this.addSyncItem("add",t)}},{key:"handleLineItemUpdate",value:function(e){var t=e.detail;this.addSyncItem("update",t)}},{key:"syncItemsHandler",value:(t=(0,r.Z)(d().mark((function e(t){var n=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t?void 0:t.length){e.next=2;break}return e.abrupt("return");case 2:setTimeout((function(){var e;if(null===(e=n.syncItems)||void 0===e?void 0:e.length){var t=n.processSyncItems();n.scUpdateLineItems.emit(t),n.syncItems=[]}}),100);case 3:case"end":return e.stop()}}),e)}))),function(_x){return t.apply(this,arguments)})},{key:"addSyncItem",value:function(e,t){this.syncItems=[].concat((0,i.Z)(this.syncItems),[{type:e,payload:t}])}},{key:"processSyncItems",value:function(){var e,t=(0,l.c)((null===(e=null==this?void 0:this.order)||void 0===e?void 0:e.line_items)||[]),n={toggle:this.toggleItem,add:this.addItem,remove:this.removeItem,update:this.updateItem};return(this.syncItems||[]).forEach((function(e){t=n[e.type](e.payload,t)})),t}},{key:"addItem",value:function(e,t){return[].concat((0,i.Z)(t),[e])}},{key:"toggleItem",value:function(e,t){var n,r=null===(n=t.find((function(t){return t.price_id===e.price_id})))||void 0===n?void 0:n.price_id;return r?t.filter((function(e){return r!==e.price_id})):[].concat((0,i.Z)(t),[e])}},{key:"removeItem",value:function(e,t){return e.price_id?t.filter((function(t){return t.price_id!==e.price_id})):t}},{key:"updateItem",value:function(e,t){var n=t.findIndex((function(t){return t.price_id===e.price_id}));return-1===n?[].concat((0,i.Z)(t),[e]):(t[n]=e,t)}},{key:"render",value:function(){return(0,a.h)("slot",null)}}],[{key:"watchers",get:function(){return{syncItems:["syncItemsHandler"]}}}]),e}()}}]);